# ESP32-S3 PID温度控制器

基于ESP32-S3的温度控制器，使用MAX31865 PT100温度传感器和SHT40温湿度传感器，实现精确的温度控制和环境监测。

## 主要功能

- 使用MAX31865 PT100传感器进行高精度温度测量
- 使用SHT40传感器监测环境温湿度
- 基于QuickPID库实现PID温度控制
- 使用旋转编码器进行温度设定和操作控制
- 实时温度曲线显示和预测
- 安全保护机制

## 硬件配置

- 主控：ESP32-S3
- 温度传感器：MAX31865 + PT100
- 环境传感器：SHT40
- 显示：SH1106 OLED (128x64)
- 控制：旋转编码器

## 软件功能

### 温度控制
- PID控制算法
- 自适应PID参数调整
- 温度滤波和校准
- 多段温度控制

### 显示功能
- 实时温度曲线显示
- 温度预测功能
- 网格线和温度刻度
- 设定温度线显示
- 环境温湿度显示
- PWM输出百分比显示

### 安全保护
- 温度超限保护
- 温度变化率监控
- 紧急停止功能
- 错误状态显示

## 使用说明

1. 旋转编码器用于调整设定温度
2. 单击编码器按钮开始/停止加热
3. 双击编码器按钮切换加热状态
4. 温度曲线显示最近20个温度点
5. 预测线显示5秒后的预测温度

## 显示界面

显示界面分为以下区域：
- 标题区域：显示当前工作状态
- 温度曲线区域：显示温度变化趋势
- 当前温度显示：大字体显示当前温度
- 控制按钮区域：显示设定温度
- PWM显示：显示PWM输出百分比
- 环境数据显示：显示环境温度

## 安全特性

- 最高温度限制：120°C
- 温度变化率限制：5°C/s
- 错误计数保护：连续3次错误触发紧急停止
- 自动温度补偿

## 开发环境

- PlatformIO
- Arduino框架
- ESP32-S3开发板支持包

## 依赖库

- U8g2lib：OLED显示
- Adafruit_MAX31865：PT100温度传感器
- Adafruit_SHT4x：环境温湿度传感器
- QuickPID：PID控制算法
- AiEsp32RotaryEncoder：旋转编码器控制

## 接线说明

- MAX31865：
  - CS: GPIO10
  - MOSI: GPIO11
  - MISO: GPIO12
  - SCK: GPIO13
- SHT40：
  - SDA: GPIO8
  - SCL: GPIO9
- OLED：
  - SDA: GPIO8
  - SCL: GPIO9
- 编码器：
  - A: GPIO5
  - B: GPIO6
  - SW: GPIO4
- PWM输出：
  - MOS: GPIO14

## 注意事项

1. 首次使用时需要进行温度校准
2. 确保散热良好，避免过热
3. 定期检查传感器连接
4. 注意观察温度变化趋势
5. 及时处理异常情况

## 项目概述
这是一个基于ESP32-S3的温度控制系统，使用PID算法实现精确的温度控制。项目包含两个主要分支：

1. `main`分支：使用MAX31865+PT100进行温度测量
2. `feature/ads1115-ntc100k`分支：使用ADS1115+NTC100K进行温度测量

## 硬件要求

### 主分支 (MAX31865+PT100)
- ESP32-S3开发板
- MAX31865温度传感器
- PT100铂电阻
- OLED显示屏 (SH1106)
- 旋转编码器
- SHT40温湿度传感器
- MOSFET驱动电路

### ADS1115+NTC100K分支
- ESP32-S3开发板
- ADS1115 16位ADC
- NTC100K热敏电阻
- 100KΩ分压电阻
- OLED显示屏 (SH1106)
- 旋转编码器
- SHT40温湿度传感器
- MOSFET驱动电路

## 功能特点

- 精确的温度控制（±0.5°C）
- 实时温度显示
- 环境温湿度监测
- 安全保护机制
- 自适应PID控制
- 紧急停止功能

## 安装说明

1. 克隆仓库：
```bash
git clone https://github.com/ashllll/ESP32.git
```

2. 选择分支：
```bash
# 主分支
git checkout main

# 或ADS1115分支
git checkout feature/ads1115-ntc100k
```

3. 使用PlatformIO打开项目

4. 根据所选分支连接相应硬件

## 硬件连接

### ADS1115+NTC100K分支连接说明

#### ADS1115连接
- VDD -> 3.3V
- GND -> GND
- SCL -> GPIO9
- SDA -> GPIO8
- A0 -> NTC100K分压电路

#### NTC100K分压电路
- NTC100K一端 -> 3.3V
- NTC100K另一端 -> 100KΩ电阻 -> GND
- 分压点 -> ADS1115 A0

#### 其他连接
- OLED SCL -> GPIO9
- OLED SDA -> GPIO8
- 编码器A -> GPIO5
- 编码器B -> GPIO6
- 编码器SW -> GPIO4
- MOSFET -> GPIO14

## 参数配置

### NTC100K参数
- B值: 3950
- 参考温度: 25°C (298.15K)
- 参考电阻: 100KΩ
- 分压电阻: 100KΩ

### PID参数
- Kp: 20.0
- Ki: 0.5
- Kd: 50.0

## 贡献指南

欢迎提交Pull Request或Issue来改进项目。

## 许可证

MIT License
